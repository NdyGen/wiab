<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            padding: 20px;
            margin: 0;
        }

        h1 {
            font-size: 20px;
            margin-bottom: 10px;
        }

        .intro {
            color: #666;
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .form-group {
            margin-bottom: 24px;
        }

        label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #333;
        }

        input[type="number"] {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            box-sizing: border-box;
        }

        input[type="number"]:focus {
            outline: none;
            border-color: #2196F3;
        }

        .hint {
            font-size: 12px;
            color: #666;
            margin-top: 6px;
        }

        .states-info {
            background: #f5f9ff;
            border-left: 4px solid #2196F3;
            padding: 16px;
            margin-bottom: 20px;
            border-radius: 4px;
        }

        .states-info h3 {
            margin: 0 0 10px 0;
            font-size: 14px;
            color: #1976D2;
        }

        .states-info ul {
            margin: 8px 0;
            padding-left: 20px;
        }

        .states-info li {
            font-size: 13px;
            color: #555;
            line-height: 1.6;
        }
    </style>
</head>
<body>
    <h1 data-i18n="title">Configure Room States</h1>
    <p class="intro" data-i18n="intro">
        The Room State Manager monitors activity in the zone you assign it to. After pairing, assign this device to a zone in the device settings.
    </p>

    <div class="states-info">
        <h3 data-i18n="states_title">Room States</h3>
        <ul>
            <li><strong>idle</strong> - <span data-i18n="state_idle">Room is inactive (no activity detected)</span></li>
            <li><strong>extended_idle</strong> - <span data-i18n="state_extended_idle">Room has been idle for a while (optional)</span></li>
            <li><strong>occupied</strong> - <span data-i18n="state_occupied">Room is active (activity detected)</span></li>
            <li><strong>extended_occupied</strong> - <span data-i18n="state_extended_occupied">Room has been active for a while (optional)</span></li>
        </ul>
    </div>

    <div class="form-group">
        <label for="idleTimeout" data-i18n="idle_timeout_label">Extended Idle Timeout (minutes)</label>
        <input type="number" id="idleTimeout" min="0" max="1440" value="0" />
        <div class="hint" data-i18n="idle_timeout_hint">
            Minutes of inactivity before transitioning to extended_idle state. Set to 0 to disable.
        </div>
    </div>

    <div class="form-group">
        <label for="occupiedTimeout" data-i18n="occupied_timeout_label">Extended Occupied Timeout (minutes)</label>
        <input type="number" id="occupiedTimeout" min="0" max="1440" value="0" />
        <div class="hint" data-i18n="occupied_timeout_hint">
            Minutes of activity before transitioning to extended_occupied state. Set to 0 to disable.
        </div>
    </div>

    <script>
        // Translations
        const translations = {
            en: {
                title: 'Configure Room States',
                intro: 'The Room State Manager monitors activity in the zone you assign it to. After pairing, assign this device to a zone in the device settings.',
                states_title: 'Room States',
                state_idle: 'Room is inactive (no activity detected)',
                state_extended_idle: 'Room has been idle for a while (optional)',
                state_occupied: 'Room is active (activity detected)',
                state_extended_occupied: 'Room has been active for a while (optional)',
                idle_timeout_label: 'Extended Idle Timeout (minutes)',
                idle_timeout_hint: 'Minutes of inactivity before transitioning to extended_idle state. Set to 0 to disable.',
                occupied_timeout_label: 'Extended Occupied Timeout (minutes)',
                occupied_timeout_hint: 'Minutes of activity before transitioning to extended_occupied state. Set to 0 to disable.'
            },
            nl: {
                title: 'Kamerstatussen Configureren',
                intro: 'De Kamer Status Manager monitort de activiteit in de zone waaraan u deze toewijst. Wijs dit apparaat na het koppelen toe aan een zone in de apparaatinstellingen.',
                states_title: 'Kamerstatussen',
                state_idle: 'Kamer is vrij (geen activiteit gedetecteerd)',
                state_extended_idle: 'Kamer is al een tijdje vrij (optioneel)',
                state_occupied: 'Kamer is bezet (activiteit gedetecteerd)',
                state_extended_occupied: 'Kamer is al een tijdje bezet (optioneel)',
                idle_timeout_label: 'Verlengde Vrije Timeout (minuten)',
                idle_timeout_hint: 'Minuten inactiviteit voordat wordt overgeschakeld naar verlengd vrije status. Stel in op 0 om uit te schakelen.',
                occupied_timeout_label: 'Verlengde Bezette Timeout (minuten)',
                occupied_timeout_hint: 'Minuten activiteit voordat wordt overgeschakeld naar verlengd bezette status. Stel in op 0 om uit te schakelen.'
            },
            de: {
                title: 'Raumzustände Konfigurieren',
                intro: 'Der Raumzustandsmanager überwacht die Aktivität in der Zone, der Sie ihn zuweisen. Weisen Sie dieses Gerät nach dem Koppeln in den Geräteeinstellungen einer Zone zu.',
                states_title: 'Raumzustände',
                state_idle: 'Raum ist inaktiv (keine Aktivität erkannt)',
                state_extended_idle: 'Raum ist schon eine Weile inaktiv (optional)',
                state_occupied: 'Raum ist besetzt (Aktivität erkannt)',
                state_extended_occupied: 'Raum ist schon eine Weile besetzt (optional)',
                idle_timeout_label: 'Erweiterte Inaktivitäts-Timeout (Minuten)',
                idle_timeout_hint: 'Minuten der Inaktivität, bevor in den erweiterten inaktiven Zustand gewechselt wird. Auf 0 setzen zum Deaktivieren.',
                occupied_timeout_label: 'Erweiterte Besetzt-Timeout (Minuten)',
                occupied_timeout_hint: 'Minuten der Aktivität, bevor in den erweiterten besetzten Zustand gewechselt wird. Auf 0 setzen zum Deaktivieren.'
            },
            no: {
                title: 'Konfigurer Romtilstander',
                intro: 'Romtilstandsbehandleren overvåker aktivitet i sonen du tildeler den til. Etter paring, tildel denne enheten til en sone i enhetsinnstillingene.',
                states_title: 'Romtilstander',
                state_idle: 'Rommet er ledig (ingen aktivitet oppdaget)',
                state_extended_idle: 'Rommet har vært ledig en stund (valgfritt)',
                state_occupied: 'Rommet er opptatt (aktivitet oppdaget)',
                state_extended_occupied: 'Rommet har vært opptatt en stund (valgfritt)',
                idle_timeout_label: 'Utvidet Ledig Tidsavbrudd (minutter)',
                idle_timeout_hint: 'Minutter med inaktivitet før overgang til utvidet ledig tilstand. Sett til 0 for å deaktivere.',
                occupied_timeout_label: 'Utvidet Opptatt Tidsavbrudd (minutter)',
                occupied_timeout_hint: 'Minutter med aktivitet før overgang til utvidet opptatt tilstand. Sett til 0 for å deaktivere.'
            },
            sv: {
                title: 'Konfigurera Rumstatus',
                intro: 'Rumstatus Hanteraren övervakar aktivitet i zonen du tilldelar den till. Efter parkoppling, tilldela denna enhet till en zon i enhetsinställningarna.',
                states_title: 'Rumstatus',
                state_idle: 'Rummet är ledigt (ingen aktivitet upptäckt)',
                state_extended_idle: 'Rummet har varit ledigt ett tag (valfritt)',
                state_occupied: 'Rummet är upptaget (aktivitet upptäckt)',
                state_extended_occupied: 'Rummet har varit upptaget ett tag (valfritt)',
                idle_timeout_label: 'Utökad Ledig Timeout (minuter)',
                idle_timeout_hint: 'Minuter av inaktivitet innan övergång till utökad ledig status. Sätt till 0 för att inaktivera.',
                occupied_timeout_label: 'Utökad Upptagen Timeout (minuter)',
                occupied_timeout_hint: 'Minuter av aktivitet innan övergång till utökad upptagen status. Sätt till 0 för att inaktivera.'
            }
        };

        // Apply translations
        function applyTranslations() {
            const lang = Homey.getLanguage() || 'en';
            const texts = translations[lang] || translations.en;

            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (texts[key]) {
                    el.textContent = texts[key];
                }
            });
        }

        // Apply translations on load
        applyTranslations();

        const idleTimeoutInput = document.getElementById('idleTimeout');
        const occupiedTimeoutInput = document.getElementById('occupiedTimeout');

        // Store timer values when changed
        function updateTimers() {
            const idleTimeout = parseInt(idleTimeoutInput.value) || 0;
            const occupiedTimeout = parseInt(occupiedTimeoutInput.value) || 0;

            Homey.emit('set_timers', {
                idleTimeout: idleTimeout,
                occupiedTimeout: occupiedTimeout
            });
        }

        idleTimeoutInput.addEventListener('input', updateTimers);
        occupiedTimeoutInput.addEventListener('input', updateTimers);

        // On ready, send initial values
        Homey.ready(() => {
            updateTimers();
        });
    </script>
</body>
</html>
